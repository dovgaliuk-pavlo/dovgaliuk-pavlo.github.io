(display "Довгалюк Павло ІПЗ-41. Лаб 3. Варіант 5. Частина 1.\n")

(define (display_formated . m_part)
  (for-each display m_part))

(define (verification_y x)
  (cond ((or (< x 2) (> x 0)) (+ (log x) (log (/ x 2))))
        ((>= x 2) (log (- (/ x 2) 1)))
   )
 )


(define (ln x)
  (define (ln_i x n)
    (if(= n 10)
       0
       (- (/ (expt (- x 1) n) n) (ln_i x (+ n 1)))
      )
    )
  (ln_i x 1)
 )


(define (y x)
  (cond ((or (< x 2) (> x 0)) (+ (ln x) (ln (/ x 2))))
        ((>= x 2) (ln (- (/ x 2) 1)))
   )
 )

(define x -1)
(display_formated "x: " x "; Y(verif):"(verification_y x)"; Y:"(y x)"; Error:" (- (verification_y x) (y x)) "\n")
(set! x -0.5)
(display_formated "x: " x "; Y(verif):"(verification_y x)"; Y:"(y x)"; Error:" (- (verification_y x) (y x)) "\n")
(set! x 0.5)
(display_formated "x: " x "; Y(verif):"(verification_y x)"; Y:"(y x)"; Error:" (- (verification_y x) (y x)) "\n")
(set! x 1)
(display_formated "x: " x "; Y(verif):"(verification_y x)"; Y:"(y x)"; Error:" (- (verification_y x) (y x)) "\n")
(set! x 1.5)
(display_formated "x: " x "; Y(verif):"(verification_y x)"; Y:"(y x)"; Error:" (- (verification_y x) (y x)) "\n")
(set! x 2)
(display_formated "x: " x "; Y(verif):"(verification_y x)"; Y:"(y x)"; Error:" (- (verification_y x) (y x)) "\n")
(set! x 2.5)
(display_formated "x: " x "; Y(verif):"(verification_y x)"; Y:"(y x)"; Error:" (- (verification_y x) (y x)) "\n")
(set! x 3)
(display_formated "x: " x "; Y(verif):"(verification_y x)"; Y:"(y x)"; Error:" (- (verification_y x) (y x)) "\n")

